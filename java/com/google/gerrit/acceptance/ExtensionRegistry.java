begin_unit|revision:0.9.5;language:Java;cregit-version:0.0.1
begin_comment
comment|// Copyright (C) 2019 The Android Open Source Project
end_comment

begin_comment
comment|//
end_comment

begin_comment
comment|// Licensed under the Apache License, Version 2.0 (the "License");
end_comment

begin_comment
comment|// you may not use this file except in compliance with the License.
end_comment

begin_comment
comment|// You may obtain a copy of the License at
end_comment

begin_comment
comment|//
end_comment

begin_comment
comment|// http://www.apache.org/licenses/LICENSE-2.0
end_comment

begin_comment
comment|//
end_comment

begin_comment
comment|// Unless required by applicable law or agreed to in writing, software
end_comment

begin_comment
comment|// distributed under the License is distributed on an "AS IS" BASIS,
end_comment

begin_comment
comment|// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
end_comment

begin_comment
comment|// See the License for the specific language governing permissions and
end_comment

begin_comment
comment|// limitations under the License.
end_comment

begin_package
DECL|package|com.google.gerrit.acceptance
package|package
name|com
operator|.
name|google
operator|.
name|gerrit
operator|.
name|acceptance
package|;
end_package

begin_import
import|import
name|com
operator|.
name|google
operator|.
name|gerrit
operator|.
name|extensions
operator|.
name|api
operator|.
name|changes
operator|.
name|ActionVisitor
import|;
end_import

begin_import
import|import
name|com
operator|.
name|google
operator|.
name|gerrit
operator|.
name|extensions
operator|.
name|events
operator|.
name|ChangeIndexedListener
import|;
end_import

begin_import
import|import
name|com
operator|.
name|google
operator|.
name|gerrit
operator|.
name|extensions
operator|.
name|registration
operator|.
name|DynamicSet
import|;
end_import

begin_import
import|import
name|com
operator|.
name|google
operator|.
name|gerrit
operator|.
name|extensions
operator|.
name|registration
operator|.
name|RegistrationHandle
import|;
end_import

begin_import
import|import
name|com
operator|.
name|google
operator|.
name|gerrit
operator|.
name|server
operator|.
name|ExceptionHook
import|;
end_import

begin_import
import|import
name|com
operator|.
name|google
operator|.
name|gerrit
operator|.
name|server
operator|.
name|change
operator|.
name|ChangeETagComputation
import|;
end_import

begin_import
import|import
name|com
operator|.
name|google
operator|.
name|gerrit
operator|.
name|server
operator|.
name|git
operator|.
name|ChangeMessageModifier
import|;
end_import

begin_import
import|import
name|com
operator|.
name|google
operator|.
name|gerrit
operator|.
name|server
operator|.
name|git
operator|.
name|validators
operator|.
name|CommitValidationListener
import|;
end_import

begin_import
import|import
name|com
operator|.
name|google
operator|.
name|gerrit
operator|.
name|server
operator|.
name|logging
operator|.
name|PerformanceLogger
import|;
end_import

begin_import
import|import
name|com
operator|.
name|google
operator|.
name|gerrit
operator|.
name|server
operator|.
name|rules
operator|.
name|SubmitRule
import|;
end_import

begin_import
import|import
name|com
operator|.
name|google
operator|.
name|gerrit
operator|.
name|server
operator|.
name|validators
operator|.
name|ProjectCreationValidationListener
import|;
end_import

begin_import
import|import
name|com
operator|.
name|google
operator|.
name|inject
operator|.
name|Inject
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|ArrayList
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|List
import|;
end_import

begin_class
DECL|class|ExtensionRegistry
specifier|public
class|class
name|ExtensionRegistry
block|{
DECL|field|changeIndexedListeners
specifier|private
specifier|final
name|DynamicSet
argument_list|<
name|ChangeIndexedListener
argument_list|>
name|changeIndexedListeners
decl_stmt|;
DECL|field|commitValidationListeners
specifier|private
specifier|final
name|DynamicSet
argument_list|<
name|CommitValidationListener
argument_list|>
name|commitValidationListeners
decl_stmt|;
DECL|field|exceptionHooks
specifier|private
specifier|final
name|DynamicSet
argument_list|<
name|ExceptionHook
argument_list|>
name|exceptionHooks
decl_stmt|;
DECL|field|performanceLoggers
specifier|private
specifier|final
name|DynamicSet
argument_list|<
name|PerformanceLogger
argument_list|>
name|performanceLoggers
decl_stmt|;
DECL|field|projectCreationValidationListeners
specifier|private
specifier|final
name|DynamicSet
argument_list|<
name|ProjectCreationValidationListener
argument_list|>
name|projectCreationValidationListeners
decl_stmt|;
DECL|field|submitRules
specifier|private
specifier|final
name|DynamicSet
argument_list|<
name|SubmitRule
argument_list|>
name|submitRules
decl_stmt|;
DECL|field|changeMessageModifiers
specifier|private
specifier|final
name|DynamicSet
argument_list|<
name|ChangeMessageModifier
argument_list|>
name|changeMessageModifiers
decl_stmt|;
DECL|field|changeETagComputations
specifier|private
specifier|final
name|DynamicSet
argument_list|<
name|ChangeETagComputation
argument_list|>
name|changeETagComputations
decl_stmt|;
DECL|field|actionVisitors
specifier|private
specifier|final
name|DynamicSet
argument_list|<
name|ActionVisitor
argument_list|>
name|actionVisitors
decl_stmt|;
annotation|@
name|Inject
DECL|method|ExtensionRegistry ( DynamicSet<ChangeIndexedListener> changeIndexedListeners, DynamicSet<CommitValidationListener> commitValidationListeners, DynamicSet<ExceptionHook> exceptionHooks, DynamicSet<PerformanceLogger> performanceLoggers, DynamicSet<ProjectCreationValidationListener> projectCreationValidationListeners, DynamicSet<SubmitRule> submitRules, DynamicSet<ChangeMessageModifier> changeMessageModifiers, DynamicSet<ChangeETagComputation> changeETagComputations, DynamicSet<ActionVisitor> actionVisitors)
name|ExtensionRegistry
parameter_list|(
name|DynamicSet
argument_list|<
name|ChangeIndexedListener
argument_list|>
name|changeIndexedListeners
parameter_list|,
name|DynamicSet
argument_list|<
name|CommitValidationListener
argument_list|>
name|commitValidationListeners
parameter_list|,
name|DynamicSet
argument_list|<
name|ExceptionHook
argument_list|>
name|exceptionHooks
parameter_list|,
name|DynamicSet
argument_list|<
name|PerformanceLogger
argument_list|>
name|performanceLoggers
parameter_list|,
name|DynamicSet
argument_list|<
name|ProjectCreationValidationListener
argument_list|>
name|projectCreationValidationListeners
parameter_list|,
name|DynamicSet
argument_list|<
name|SubmitRule
argument_list|>
name|submitRules
parameter_list|,
name|DynamicSet
argument_list|<
name|ChangeMessageModifier
argument_list|>
name|changeMessageModifiers
parameter_list|,
name|DynamicSet
argument_list|<
name|ChangeETagComputation
argument_list|>
name|changeETagComputations
parameter_list|,
name|DynamicSet
argument_list|<
name|ActionVisitor
argument_list|>
name|actionVisitors
parameter_list|)
block|{
name|this
operator|.
name|changeIndexedListeners
operator|=
name|changeIndexedListeners
expr_stmt|;
name|this
operator|.
name|commitValidationListeners
operator|=
name|commitValidationListeners
expr_stmt|;
name|this
operator|.
name|exceptionHooks
operator|=
name|exceptionHooks
expr_stmt|;
name|this
operator|.
name|performanceLoggers
operator|=
name|performanceLoggers
expr_stmt|;
name|this
operator|.
name|projectCreationValidationListeners
operator|=
name|projectCreationValidationListeners
expr_stmt|;
name|this
operator|.
name|submitRules
operator|=
name|submitRules
expr_stmt|;
name|this
operator|.
name|changeMessageModifiers
operator|=
name|changeMessageModifiers
expr_stmt|;
name|this
operator|.
name|changeETagComputations
operator|=
name|changeETagComputations
expr_stmt|;
name|this
operator|.
name|actionVisitors
operator|=
name|actionVisitors
expr_stmt|;
block|}
DECL|method|newRegistration ()
specifier|public
name|Registration
name|newRegistration
parameter_list|()
block|{
return|return
operator|new
name|Registration
argument_list|()
return|;
block|}
DECL|class|Registration
specifier|public
class|class
name|Registration
implements|implements
name|AutoCloseable
block|{
DECL|field|registrationHandles
specifier|private
specifier|final
name|List
argument_list|<
name|RegistrationHandle
argument_list|>
name|registrationHandles
init|=
operator|new
name|ArrayList
argument_list|<>
argument_list|()
decl_stmt|;
DECL|method|add (ChangeIndexedListener changeIndexedListener)
specifier|public
name|Registration
name|add
parameter_list|(
name|ChangeIndexedListener
name|changeIndexedListener
parameter_list|)
block|{
return|return
name|add
argument_list|(
name|changeIndexedListeners
argument_list|,
name|changeIndexedListener
argument_list|)
return|;
block|}
DECL|method|add (CommitValidationListener commitValidationListener)
specifier|public
name|Registration
name|add
parameter_list|(
name|CommitValidationListener
name|commitValidationListener
parameter_list|)
block|{
return|return
name|add
argument_list|(
name|commitValidationListeners
argument_list|,
name|commitValidationListener
argument_list|)
return|;
block|}
DECL|method|add (ExceptionHook exceptionHook)
specifier|public
name|Registration
name|add
parameter_list|(
name|ExceptionHook
name|exceptionHook
parameter_list|)
block|{
return|return
name|add
argument_list|(
name|exceptionHooks
argument_list|,
name|exceptionHook
argument_list|)
return|;
block|}
DECL|method|add (PerformanceLogger performanceLogger)
specifier|public
name|Registration
name|add
parameter_list|(
name|PerformanceLogger
name|performanceLogger
parameter_list|)
block|{
return|return
name|add
argument_list|(
name|performanceLoggers
argument_list|,
name|performanceLogger
argument_list|)
return|;
block|}
DECL|method|add (ProjectCreationValidationListener projectCreationListener)
specifier|public
name|Registration
name|add
parameter_list|(
name|ProjectCreationValidationListener
name|projectCreationListener
parameter_list|)
block|{
return|return
name|add
argument_list|(
name|projectCreationValidationListeners
argument_list|,
name|projectCreationListener
argument_list|)
return|;
block|}
DECL|method|add (SubmitRule submitRule)
specifier|public
name|Registration
name|add
parameter_list|(
name|SubmitRule
name|submitRule
parameter_list|)
block|{
return|return
name|add
argument_list|(
name|submitRules
argument_list|,
name|submitRule
argument_list|)
return|;
block|}
DECL|method|add (ChangeMessageModifier changeMessageModifier)
specifier|public
name|Registration
name|add
parameter_list|(
name|ChangeMessageModifier
name|changeMessageModifier
parameter_list|)
block|{
return|return
name|add
argument_list|(
name|changeMessageModifiers
argument_list|,
name|changeMessageModifier
argument_list|)
return|;
block|}
DECL|method|add (ChangeETagComputation changeETagComputation)
specifier|public
name|Registration
name|add
parameter_list|(
name|ChangeETagComputation
name|changeETagComputation
parameter_list|)
block|{
return|return
name|add
argument_list|(
name|changeETagComputations
argument_list|,
name|changeETagComputation
argument_list|)
return|;
block|}
DECL|method|add (ActionVisitor actionVisitor)
specifier|public
name|Registration
name|add
parameter_list|(
name|ActionVisitor
name|actionVisitor
parameter_list|)
block|{
return|return
name|add
argument_list|(
name|actionVisitors
argument_list|,
name|actionVisitor
argument_list|)
return|;
block|}
DECL|method|add (DynamicSet<T> dynamicSet, T extension)
specifier|private
parameter_list|<
name|T
parameter_list|>
name|Registration
name|add
parameter_list|(
name|DynamicSet
argument_list|<
name|T
argument_list|>
name|dynamicSet
parameter_list|,
name|T
name|extension
parameter_list|)
block|{
name|RegistrationHandle
name|registrationHandle
init|=
name|dynamicSet
operator|.
name|add
argument_list|(
literal|"gerrit"
argument_list|,
name|extension
argument_list|)
decl_stmt|;
name|registrationHandles
operator|.
name|add
argument_list|(
name|registrationHandle
argument_list|)
expr_stmt|;
return|return
name|this
return|;
block|}
annotation|@
name|Override
DECL|method|close ()
specifier|public
name|void
name|close
parameter_list|()
block|{
name|registrationHandles
operator|.
name|forEach
argument_list|(
name|h
lambda|->
name|h
operator|.
name|remove
argument_list|()
argument_list|)
expr_stmt|;
block|}
block|}
block|}
end_class

end_unit

