begin_unit|revision:0.9.5;language:Java;cregit-version:0.0.1
begin_comment
comment|// Copyright (C) 2015 The Android Open Source Project
end_comment

begin_comment
comment|//
end_comment

begin_comment
comment|// Licensed under the Apache License, Version 2.0 (the "License");
end_comment

begin_comment
comment|// you may not use this file except in compliance with the License.
end_comment

begin_comment
comment|// You may obtain a copy of the License at
end_comment

begin_comment
comment|//
end_comment

begin_comment
comment|// http://www.apache.org/licenses/LICENSE-2.0
end_comment

begin_comment
comment|//
end_comment

begin_comment
comment|// Unless required by applicable law or agreed to in writing, software
end_comment

begin_comment
comment|// distributed under the License is distributed on an "AS IS" BASIS,
end_comment

begin_comment
comment|// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
end_comment

begin_comment
comment|// See the License for the specific language governing permissions and
end_comment

begin_comment
comment|// limitations under the License.
end_comment

begin_package
DECL|package|com.google.gerrit.server.api.groups
package|package
name|com
operator|.
name|google
operator|.
name|gerrit
operator|.
name|server
operator|.
name|api
operator|.
name|groups
package|;
end_package

begin_import
import|import
name|com
operator|.
name|google
operator|.
name|gerrit
operator|.
name|common
operator|.
name|errors
operator|.
name|NoSuchGroupException
import|;
end_import

begin_import
import|import
name|com
operator|.
name|google
operator|.
name|gerrit
operator|.
name|extensions
operator|.
name|api
operator|.
name|groups
operator|.
name|GroupApi
import|;
end_import

begin_import
import|import
name|com
operator|.
name|google
operator|.
name|gerrit
operator|.
name|extensions
operator|.
name|common
operator|.
name|AccountInfo
import|;
end_import

begin_import
import|import
name|com
operator|.
name|google
operator|.
name|gerrit
operator|.
name|extensions
operator|.
name|common
operator|.
name|GroupAuditEventInfo
import|;
end_import

begin_import
import|import
name|com
operator|.
name|google
operator|.
name|gerrit
operator|.
name|extensions
operator|.
name|common
operator|.
name|GroupInfo
import|;
end_import

begin_import
import|import
name|com
operator|.
name|google
operator|.
name|gerrit
operator|.
name|extensions
operator|.
name|common
operator|.
name|GroupOptionsInfo
import|;
end_import

begin_import
import|import
name|com
operator|.
name|google
operator|.
name|gerrit
operator|.
name|extensions
operator|.
name|restapi
operator|.
name|ResourceNotFoundException
import|;
end_import

begin_import
import|import
name|com
operator|.
name|google
operator|.
name|gerrit
operator|.
name|extensions
operator|.
name|restapi
operator|.
name|RestApiException
import|;
end_import

begin_import
import|import
name|com
operator|.
name|google
operator|.
name|gerrit
operator|.
name|server
operator|.
name|group
operator|.
name|AddIncludedGroups
import|;
end_import

begin_import
import|import
name|com
operator|.
name|google
operator|.
name|gerrit
operator|.
name|server
operator|.
name|group
operator|.
name|AddMembers
import|;
end_import

begin_import
import|import
name|com
operator|.
name|google
operator|.
name|gerrit
operator|.
name|server
operator|.
name|group
operator|.
name|DeleteIncludedGroups
import|;
end_import

begin_import
import|import
name|com
operator|.
name|google
operator|.
name|gerrit
operator|.
name|server
operator|.
name|group
operator|.
name|DeleteMembers
import|;
end_import

begin_import
import|import
name|com
operator|.
name|google
operator|.
name|gerrit
operator|.
name|server
operator|.
name|group
operator|.
name|GetAuditLog
import|;
end_import

begin_import
import|import
name|com
operator|.
name|google
operator|.
name|gerrit
operator|.
name|server
operator|.
name|group
operator|.
name|GetDescription
import|;
end_import

begin_import
import|import
name|com
operator|.
name|google
operator|.
name|gerrit
operator|.
name|server
operator|.
name|group
operator|.
name|GetDetail
import|;
end_import

begin_import
import|import
name|com
operator|.
name|google
operator|.
name|gerrit
operator|.
name|server
operator|.
name|group
operator|.
name|GetGroup
import|;
end_import

begin_import
import|import
name|com
operator|.
name|google
operator|.
name|gerrit
operator|.
name|server
operator|.
name|group
operator|.
name|GetName
import|;
end_import

begin_import
import|import
name|com
operator|.
name|google
operator|.
name|gerrit
operator|.
name|server
operator|.
name|group
operator|.
name|GetOptions
import|;
end_import

begin_import
import|import
name|com
operator|.
name|google
operator|.
name|gerrit
operator|.
name|server
operator|.
name|group
operator|.
name|GetOwner
import|;
end_import

begin_import
import|import
name|com
operator|.
name|google
operator|.
name|gerrit
operator|.
name|server
operator|.
name|group
operator|.
name|GroupResource
import|;
end_import

begin_import
import|import
name|com
operator|.
name|google
operator|.
name|gerrit
operator|.
name|server
operator|.
name|group
operator|.
name|ListIncludedGroups
import|;
end_import

begin_import
import|import
name|com
operator|.
name|google
operator|.
name|gerrit
operator|.
name|server
operator|.
name|group
operator|.
name|ListMembers
import|;
end_import

begin_import
import|import
name|com
operator|.
name|google
operator|.
name|gerrit
operator|.
name|server
operator|.
name|group
operator|.
name|PutDescription
import|;
end_import

begin_import
import|import
name|com
operator|.
name|google
operator|.
name|gerrit
operator|.
name|server
operator|.
name|group
operator|.
name|PutName
import|;
end_import

begin_import
import|import
name|com
operator|.
name|google
operator|.
name|gerrit
operator|.
name|server
operator|.
name|group
operator|.
name|PutOptions
import|;
end_import

begin_import
import|import
name|com
operator|.
name|google
operator|.
name|gerrit
operator|.
name|server
operator|.
name|group
operator|.
name|PutOwner
import|;
end_import

begin_import
import|import
name|com
operator|.
name|google
operator|.
name|gwtorm
operator|.
name|server
operator|.
name|OrmException
import|;
end_import

begin_import
import|import
name|com
operator|.
name|google
operator|.
name|inject
operator|.
name|assistedinject
operator|.
name|Assisted
import|;
end_import

begin_import
import|import
name|com
operator|.
name|google
operator|.
name|inject
operator|.
name|assistedinject
operator|.
name|AssistedInject
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|Arrays
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|List
import|;
end_import

begin_class
DECL|class|GroupApiImpl
class|class
name|GroupApiImpl
implements|implements
name|GroupApi
block|{
DECL|interface|Factory
interface|interface
name|Factory
block|{
DECL|method|create (GroupResource rsrc)
name|GroupApiImpl
name|create
parameter_list|(
name|GroupResource
name|rsrc
parameter_list|)
function_decl|;
block|}
DECL|field|getGroup
specifier|private
specifier|final
name|GetGroup
name|getGroup
decl_stmt|;
DECL|field|getDetail
specifier|private
specifier|final
name|GetDetail
name|getDetail
decl_stmt|;
DECL|field|getName
specifier|private
specifier|final
name|GetName
name|getName
decl_stmt|;
DECL|field|putName
specifier|private
specifier|final
name|PutName
name|putName
decl_stmt|;
DECL|field|getOwner
specifier|private
specifier|final
name|GetOwner
name|getOwner
decl_stmt|;
DECL|field|putOwner
specifier|private
specifier|final
name|PutOwner
name|putOwner
decl_stmt|;
DECL|field|getDescription
specifier|private
specifier|final
name|GetDescription
name|getDescription
decl_stmt|;
DECL|field|putDescription
specifier|private
specifier|final
name|PutDescription
name|putDescription
decl_stmt|;
DECL|field|getOptions
specifier|private
specifier|final
name|GetOptions
name|getOptions
decl_stmt|;
DECL|field|putOptions
specifier|private
specifier|final
name|PutOptions
name|putOptions
decl_stmt|;
DECL|field|listMembers
specifier|private
specifier|final
name|ListMembers
name|listMembers
decl_stmt|;
DECL|field|addMembers
specifier|private
specifier|final
name|AddMembers
name|addMembers
decl_stmt|;
DECL|field|deleteMembers
specifier|private
specifier|final
name|DeleteMembers
name|deleteMembers
decl_stmt|;
DECL|field|listGroups
specifier|private
specifier|final
name|ListIncludedGroups
name|listGroups
decl_stmt|;
DECL|field|addGroups
specifier|private
specifier|final
name|AddIncludedGroups
name|addGroups
decl_stmt|;
DECL|field|deleteGroups
specifier|private
specifier|final
name|DeleteIncludedGroups
name|deleteGroups
decl_stmt|;
DECL|field|getAuditLog
specifier|private
specifier|final
name|GetAuditLog
name|getAuditLog
decl_stmt|;
DECL|field|rsrc
specifier|private
specifier|final
name|GroupResource
name|rsrc
decl_stmt|;
annotation|@
name|AssistedInject
DECL|method|GroupApiImpl ( GetGroup getGroup, GetDetail getDetail, GetName getName, PutName putName, GetOwner getOwner, PutOwner putOwner, GetDescription getDescription, PutDescription putDescription, GetOptions getOptions, PutOptions putOptions, ListMembers listMembers, AddMembers addMembers, DeleteMembers deleteMembers, ListIncludedGroups listGroups, AddIncludedGroups addGroups, DeleteIncludedGroups deleteGroups, GetAuditLog getAuditLog, @Assisted GroupResource rsrc)
name|GroupApiImpl
parameter_list|(
name|GetGroup
name|getGroup
parameter_list|,
name|GetDetail
name|getDetail
parameter_list|,
name|GetName
name|getName
parameter_list|,
name|PutName
name|putName
parameter_list|,
name|GetOwner
name|getOwner
parameter_list|,
name|PutOwner
name|putOwner
parameter_list|,
name|GetDescription
name|getDescription
parameter_list|,
name|PutDescription
name|putDescription
parameter_list|,
name|GetOptions
name|getOptions
parameter_list|,
name|PutOptions
name|putOptions
parameter_list|,
name|ListMembers
name|listMembers
parameter_list|,
name|AddMembers
name|addMembers
parameter_list|,
name|DeleteMembers
name|deleteMembers
parameter_list|,
name|ListIncludedGroups
name|listGroups
parameter_list|,
name|AddIncludedGroups
name|addGroups
parameter_list|,
name|DeleteIncludedGroups
name|deleteGroups
parameter_list|,
name|GetAuditLog
name|getAuditLog
parameter_list|,
annotation|@
name|Assisted
name|GroupResource
name|rsrc
parameter_list|)
block|{
name|this
operator|.
name|getGroup
operator|=
name|getGroup
expr_stmt|;
name|this
operator|.
name|getDetail
operator|=
name|getDetail
expr_stmt|;
name|this
operator|.
name|getName
operator|=
name|getName
expr_stmt|;
name|this
operator|.
name|putName
operator|=
name|putName
expr_stmt|;
name|this
operator|.
name|getOwner
operator|=
name|getOwner
expr_stmt|;
name|this
operator|.
name|putOwner
operator|=
name|putOwner
expr_stmt|;
name|this
operator|.
name|getDescription
operator|=
name|getDescription
expr_stmt|;
name|this
operator|.
name|putDescription
operator|=
name|putDescription
expr_stmt|;
name|this
operator|.
name|getOptions
operator|=
name|getOptions
expr_stmt|;
name|this
operator|.
name|putOptions
operator|=
name|putOptions
expr_stmt|;
name|this
operator|.
name|listMembers
operator|=
name|listMembers
expr_stmt|;
name|this
operator|.
name|addMembers
operator|=
name|addMembers
expr_stmt|;
name|this
operator|.
name|deleteMembers
operator|=
name|deleteMembers
expr_stmt|;
name|this
operator|.
name|listGroups
operator|=
name|listGroups
expr_stmt|;
name|this
operator|.
name|addGroups
operator|=
name|addGroups
expr_stmt|;
name|this
operator|.
name|deleteGroups
operator|=
name|deleteGroups
expr_stmt|;
name|this
operator|.
name|getAuditLog
operator|=
name|getAuditLog
expr_stmt|;
name|this
operator|.
name|rsrc
operator|=
name|rsrc
expr_stmt|;
block|}
annotation|@
name|Override
DECL|method|get ()
specifier|public
name|GroupInfo
name|get
parameter_list|()
throws|throws
name|RestApiException
block|{
try|try
block|{
return|return
name|getGroup
operator|.
name|apply
argument_list|(
name|rsrc
argument_list|)
return|;
block|}
catch|catch
parameter_list|(
name|OrmException
name|e
parameter_list|)
block|{
throw|throw
operator|new
name|RestApiException
argument_list|(
literal|"Cannot retrieve group"
argument_list|,
name|e
argument_list|)
throw|;
block|}
block|}
annotation|@
name|Override
DECL|method|detail ()
specifier|public
name|GroupInfo
name|detail
parameter_list|()
throws|throws
name|RestApiException
block|{
try|try
block|{
return|return
name|getDetail
operator|.
name|apply
argument_list|(
name|rsrc
argument_list|)
return|;
block|}
catch|catch
parameter_list|(
name|OrmException
name|e
parameter_list|)
block|{
throw|throw
operator|new
name|RestApiException
argument_list|(
literal|"Cannot retrieve group"
argument_list|,
name|e
argument_list|)
throw|;
block|}
block|}
annotation|@
name|Override
DECL|method|name ()
specifier|public
name|String
name|name
parameter_list|()
throws|throws
name|RestApiException
block|{
return|return
name|getName
operator|.
name|apply
argument_list|(
name|rsrc
argument_list|)
return|;
block|}
annotation|@
name|Override
DECL|method|name (String name)
specifier|public
name|void
name|name
parameter_list|(
name|String
name|name
parameter_list|)
throws|throws
name|RestApiException
block|{
name|PutName
operator|.
name|Input
name|in
init|=
operator|new
name|PutName
operator|.
name|Input
argument_list|()
decl_stmt|;
name|in
operator|.
name|name
operator|=
name|name
expr_stmt|;
try|try
block|{
name|putName
operator|.
name|apply
argument_list|(
name|rsrc
argument_list|,
name|in
argument_list|)
expr_stmt|;
block|}
catch|catch
parameter_list|(
name|NoSuchGroupException
name|e
parameter_list|)
block|{
throw|throw
operator|new
name|ResourceNotFoundException
argument_list|(
name|name
argument_list|,
name|e
argument_list|)
throw|;
block|}
catch|catch
parameter_list|(
name|OrmException
name|e
parameter_list|)
block|{
throw|throw
operator|new
name|RestApiException
argument_list|(
literal|"Cannot put group name"
argument_list|,
name|e
argument_list|)
throw|;
block|}
block|}
annotation|@
name|Override
DECL|method|owner ()
specifier|public
name|GroupInfo
name|owner
parameter_list|()
throws|throws
name|RestApiException
block|{
try|try
block|{
return|return
name|getOwner
operator|.
name|apply
argument_list|(
name|rsrc
argument_list|)
return|;
block|}
catch|catch
parameter_list|(
name|OrmException
name|e
parameter_list|)
block|{
throw|throw
operator|new
name|RestApiException
argument_list|(
literal|"Cannot get group owner"
argument_list|,
name|e
argument_list|)
throw|;
block|}
block|}
annotation|@
name|Override
DECL|method|owner (String owner)
specifier|public
name|void
name|owner
parameter_list|(
name|String
name|owner
parameter_list|)
throws|throws
name|RestApiException
block|{
name|PutOwner
operator|.
name|Input
name|in
init|=
operator|new
name|PutOwner
operator|.
name|Input
argument_list|()
decl_stmt|;
name|in
operator|.
name|owner
operator|=
name|owner
expr_stmt|;
try|try
block|{
name|putOwner
operator|.
name|apply
argument_list|(
name|rsrc
argument_list|,
name|in
argument_list|)
expr_stmt|;
block|}
catch|catch
parameter_list|(
name|OrmException
name|e
parameter_list|)
block|{
throw|throw
operator|new
name|RestApiException
argument_list|(
literal|"Cannot put group owner"
argument_list|,
name|e
argument_list|)
throw|;
block|}
block|}
annotation|@
name|Override
DECL|method|description ()
specifier|public
name|String
name|description
parameter_list|()
throws|throws
name|RestApiException
block|{
return|return
name|getDescription
operator|.
name|apply
argument_list|(
name|rsrc
argument_list|)
return|;
block|}
annotation|@
name|Override
DECL|method|description (String description)
specifier|public
name|void
name|description
parameter_list|(
name|String
name|description
parameter_list|)
throws|throws
name|RestApiException
block|{
name|PutDescription
operator|.
name|Input
name|in
init|=
operator|new
name|PutDescription
operator|.
name|Input
argument_list|()
decl_stmt|;
name|in
operator|.
name|description
operator|=
name|description
expr_stmt|;
try|try
block|{
name|putDescription
operator|.
name|apply
argument_list|(
name|rsrc
argument_list|,
name|in
argument_list|)
expr_stmt|;
block|}
catch|catch
parameter_list|(
name|OrmException
name|e
parameter_list|)
block|{
throw|throw
operator|new
name|RestApiException
argument_list|(
literal|"Cannot put group description"
argument_list|,
name|e
argument_list|)
throw|;
block|}
block|}
annotation|@
name|Override
DECL|method|options ()
specifier|public
name|GroupOptionsInfo
name|options
parameter_list|()
throws|throws
name|RestApiException
block|{
return|return
name|getOptions
operator|.
name|apply
argument_list|(
name|rsrc
argument_list|)
return|;
block|}
annotation|@
name|Override
DECL|method|options (GroupOptionsInfo options)
specifier|public
name|void
name|options
parameter_list|(
name|GroupOptionsInfo
name|options
parameter_list|)
throws|throws
name|RestApiException
block|{
try|try
block|{
name|putOptions
operator|.
name|apply
argument_list|(
name|rsrc
argument_list|,
name|options
argument_list|)
expr_stmt|;
block|}
catch|catch
parameter_list|(
name|OrmException
name|e
parameter_list|)
block|{
throw|throw
operator|new
name|RestApiException
argument_list|(
literal|"Cannot put group options"
argument_list|,
name|e
argument_list|)
throw|;
block|}
block|}
annotation|@
name|Override
DECL|method|members ()
specifier|public
name|List
argument_list|<
name|AccountInfo
argument_list|>
name|members
parameter_list|()
throws|throws
name|RestApiException
block|{
return|return
name|members
argument_list|(
literal|false
argument_list|)
return|;
block|}
annotation|@
name|Override
DECL|method|members (boolean recursive)
specifier|public
name|List
argument_list|<
name|AccountInfo
argument_list|>
name|members
parameter_list|(
name|boolean
name|recursive
parameter_list|)
throws|throws
name|RestApiException
block|{
name|listMembers
operator|.
name|setRecursive
argument_list|(
name|recursive
argument_list|)
expr_stmt|;
try|try
block|{
return|return
name|listMembers
operator|.
name|apply
argument_list|(
name|rsrc
argument_list|)
return|;
block|}
catch|catch
parameter_list|(
name|OrmException
name|e
parameter_list|)
block|{
throw|throw
operator|new
name|RestApiException
argument_list|(
literal|"Cannot list group members"
argument_list|,
name|e
argument_list|)
throw|;
block|}
block|}
annotation|@
name|Override
DECL|method|addMembers (String... members)
specifier|public
name|void
name|addMembers
parameter_list|(
name|String
modifier|...
name|members
parameter_list|)
throws|throws
name|RestApiException
block|{
try|try
block|{
name|addMembers
operator|.
name|apply
argument_list|(
name|rsrc
argument_list|,
name|AddMembers
operator|.
name|Input
operator|.
name|fromMembers
argument_list|(
name|Arrays
operator|.
name|asList
argument_list|(
name|members
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
catch|catch
parameter_list|(
name|OrmException
name|e
parameter_list|)
block|{
throw|throw
operator|new
name|RestApiException
argument_list|(
literal|"Cannot add group members"
argument_list|,
name|e
argument_list|)
throw|;
block|}
block|}
annotation|@
name|Override
DECL|method|removeMembers (String... members)
specifier|public
name|void
name|removeMembers
parameter_list|(
name|String
modifier|...
name|members
parameter_list|)
throws|throws
name|RestApiException
block|{
try|try
block|{
name|deleteMembers
operator|.
name|apply
argument_list|(
name|rsrc
argument_list|,
name|AddMembers
operator|.
name|Input
operator|.
name|fromMembers
argument_list|(
name|Arrays
operator|.
name|asList
argument_list|(
name|members
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
catch|catch
parameter_list|(
name|OrmException
name|e
parameter_list|)
block|{
throw|throw
operator|new
name|RestApiException
argument_list|(
literal|"Cannot remove group members"
argument_list|,
name|e
argument_list|)
throw|;
block|}
block|}
annotation|@
name|Override
DECL|method|includedGroups ()
specifier|public
name|List
argument_list|<
name|GroupInfo
argument_list|>
name|includedGroups
parameter_list|()
throws|throws
name|RestApiException
block|{
try|try
block|{
return|return
name|listGroups
operator|.
name|apply
argument_list|(
name|rsrc
argument_list|)
return|;
block|}
catch|catch
parameter_list|(
name|OrmException
name|e
parameter_list|)
block|{
throw|throw
operator|new
name|RestApiException
argument_list|(
literal|"Cannot list included groups"
argument_list|,
name|e
argument_list|)
throw|;
block|}
block|}
annotation|@
name|Override
DECL|method|addGroups (String... groups)
specifier|public
name|void
name|addGroups
parameter_list|(
name|String
modifier|...
name|groups
parameter_list|)
throws|throws
name|RestApiException
block|{
try|try
block|{
name|addGroups
operator|.
name|apply
argument_list|(
name|rsrc
argument_list|,
name|AddIncludedGroups
operator|.
name|Input
operator|.
name|fromGroups
argument_list|(
name|Arrays
operator|.
name|asList
argument_list|(
name|groups
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
catch|catch
parameter_list|(
name|OrmException
name|e
parameter_list|)
block|{
throw|throw
operator|new
name|RestApiException
argument_list|(
literal|"Cannot add group members"
argument_list|,
name|e
argument_list|)
throw|;
block|}
block|}
annotation|@
name|Override
DECL|method|removeGroups (String... groups)
specifier|public
name|void
name|removeGroups
parameter_list|(
name|String
modifier|...
name|groups
parameter_list|)
throws|throws
name|RestApiException
block|{
try|try
block|{
name|deleteGroups
operator|.
name|apply
argument_list|(
name|rsrc
argument_list|,
name|AddIncludedGroups
operator|.
name|Input
operator|.
name|fromGroups
argument_list|(
name|Arrays
operator|.
name|asList
argument_list|(
name|groups
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
catch|catch
parameter_list|(
name|OrmException
name|e
parameter_list|)
block|{
throw|throw
operator|new
name|RestApiException
argument_list|(
literal|"Cannot remove group members"
argument_list|,
name|e
argument_list|)
throw|;
block|}
block|}
annotation|@
name|Override
DECL|method|auditLog ()
specifier|public
name|List
argument_list|<
name|?
extends|extends
name|GroupAuditEventInfo
argument_list|>
name|auditLog
parameter_list|()
throws|throws
name|RestApiException
block|{
try|try
block|{
return|return
name|getAuditLog
operator|.
name|apply
argument_list|(
name|rsrc
argument_list|)
return|;
block|}
catch|catch
parameter_list|(
name|OrmException
name|e
parameter_list|)
block|{
throw|throw
operator|new
name|RestApiException
argument_list|(
literal|"Cannot get audit log"
argument_list|,
name|e
argument_list|)
throw|;
block|}
block|}
block|}
end_class

end_unit

